(function(B){var C=function(){};C.__name__=!0;C.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};var f=function(){};f.__name__=!0;f.main=function(){var a=window.document.getElementById("canvas");a.width=a.clientWidth;a.height=a.clientHeight;f.ctx=a.getContext("2d",null);window.requestAnimationFrame(f.draw);var b=new k(4);b[0]=100;b[1]=100;f.mouseCirc=new x(b,16);b=new k(4);b[0]=110;b[1]=55;var c=new k(4);c[0]=200;c[1]=62;var d=new k(4);d[0]=150;d[1]=120;f.poly=new y([b,
c,d]);f.hb=new D;a.addEventListener("mousemove",f.onMouseMove);a.addEventListener("touchstart",f.onTouch);a.addEventListener("touchmove",f.onTouch)};f.onMouseMove=function(a){f.moveCircle(a.clientX,a.clientY)};f.onTouch=function(a){f.moveCircle(a.touches[0].clientX,a.touches[0].clientY);a.stopPropagation()};f.moveCircle=function(a,b){var c=f.ctx.canvas.getBoundingClientRect();f.mouseCirc.get_centre()[0]=a-c.left;f.mouseCirc.get_centre()[1]=b-c.top};f.draw=function(a){f.lastTime=a;a=f.hb.intersect(f.poly,
f.mouseCirc);if(null!=a){var b=f.mouseCirc.get_centre(),c=f.mouseCirc.get_centre();c[0]=b[0]+a[0];c[1]=b[1]+a[1]}f.ctx.canvas.width=f.ctx.canvas.clientWidth;f.ctx.canvas.height=f.ctx.canvas.clientHeight;f.ctx.clearRect(0,0,f.ctx.canvas.clientWidth,f.ctx.canvas.clientHeight);f.ctx.beginPath();f.ctx.moveTo(f.poly.vertices[0][0],f.poly.vertices[0][1]);a=1;for(b=f.poly.vertices.length;a<b;)c=a++,f.ctx.lineTo(f.poly.vertices[c][0],f.poly.vertices[c][1]);f.ctx.lineTo(f.poly.vertices[0][0],f.poly.vertices[0][1]);
f.ctx.strokeStyle="#324D5C";f.ctx.lineWidth=4;f.ctx.lineJoin="round";f.ctx.lineCap="round";f.ctx.stroke();f.ctx.beginPath();f.ctx.arc(f.mouseCirc.get_centre()[0],f.mouseCirc.get_centre()[1],f.mouseCirc.radius,0,2*Math.PI);f.ctx.fillStyle="#46B39D";f.ctx.fill();window.requestAnimationFrame(f.draw)};Math.__name__=!0;var E=function(){};E.__name__=!0;E.string=function(a){return g.__string_rec(a,"")};var n=function(){};n.__name__=!0;n.lerp=function(a,b,c){return a+c*(b-a)};n.translate=function(a,b){b[0]=
1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;b[12]=a[0];b[13]=a[1];b[14]=a[2];return b};n.rotate=function(a,b){var c=a[0]+a[0],d=a[1]+a[1],e=a[2]+a[2],H=a[0]*c,h=a[0]*d,f=a[0]*e,J=a[1]*d,k=a[1]*e,l=a[2]*e,c=a[3]*c,d=a[3]*d,e=a[3]*e;b[0]=1-(J+l);b[4]=h-e;b[8]=f+d;b[12]=0;b[1]=h+e;b[5]=1-(H+l);b[9]=k-c;b[13]=0;b[2]=f-d;b[6]=k+c;b[10]=1-(H+J);b[14]=0;b[3]=0;b[7]=0;b[11]=0;b[15]=1;return b};n.scale=function(a,b){b[0]=1;b[1]=0;b[2]=0;
b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;b[0]=a[0];b[5]=a[1];b[10]=a[2];return b};n.transform=function(a,b,c,d){var e=b[0]+b[0],f=b[1]+b[1],h=b[2]+b[2],I=b[0]*e,k=b[0]*f,g=b[0]*h,l=b[1]*f,m=b[1]*h,n=b[2]*h,e=b[3]*e,f=b[3]*f;b=b[3]*h;d[0]=(1-(l+n))*c[0];d[1]=(k+b)*c[0];d[2]=(g-f)*c[0];d[3]=0;d[4]=(k-b)*c[1];d[5]=(1-(I+n))*c[1];d[6]=(m+e)*c[1];d[7]=0;d[8]=(g+f)*c[2];d[9]=(m-e)*c[2];d[10]=(1-(I+l))*c[2];d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];
d[15]=1;return d};n.lookAt=function(a,b,c,d){var e,f,h,k,g,p,l,m;if(Math.abs(a[0]-b[0])<n.EPSILON&&Math.abs(a[1]-b[1])<n.EPSILON&&Math.abs(a[2]-b[2])<n.EPSILON)return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d;g=a[0]-b[0];p=a[1]-b[1];l=a[2]-b[2];m=1/Math.sqrt(g*g+p*p+l*l);g*=m;p*=m;l*=m;b=c[1]*l-c[2]*p;e=c[2]*g-c[0]*l;c=c[0]*p-c[1]*g;m=Math.sqrt(b*b+e*e+c*c);m<=n.EPSILON?c=e=b=0:(m=1/m,b*=m,e*=m,c*=m);f=p*c-l*e;h=l*b-g*c;
k=g*e-p*b;m=Math.sqrt(f*f+h*h+k*k);m<=n.EPSILON?k=h=f=0:(m=1/m,f*=m,h*=m,k*=m);d[0]=b;d[1]=f;d[2]=g;d[3]=0;d[4]=e;d[5]=h;d[6]=p;d[7]=0;d[8]=c;d[9]=k;d[10]=l;d[11]=0;d[12]=-(b*a[0]+e*a[1]+c*a[2]);d[13]=-(f*a[0]+h*a[1]+k*a[2]);d[14]=-(g*a[0]+p*a[1]+l*a[2]);d[15]=1;return d};n.perspective=function(a,b,c,d,e){a=1/Math.tan(a/2);var f=1/(c-d);e[0]=a/b;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(d+c)*f;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*d*c*f;e[15]=0;return e};n.orthographic=function(a,
b,c,d,e,f,h){null==f&&(f=1);null==e&&(e=-1);var k=1/(b-a),g=1/(d-c),p=1/(f-e);h[0]=2*k;h[4]=0;h[8]=0;h[12]=-1*(a+b)*k;h[1]=0;h[5]=2*g;h[9]=0;h[13]=-1*(d+c)*g;h[2]=0;h[6]=0;h[10]=-2*p;h[14]=-1*(f+e)*p;h[3]=0;h[7]=0;h[11]=0;h[15]=1;return h};n.frustum=function(a,b,c,d,e,f,h){null==f&&(f=1);null==e&&(e=-1);var k=1/(d-c),g=1/(e-f);h[0]=1/(b-a)*e*2;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*e*k;h[6]=0;h[7]=0;h[8]=(b+a)*k;h[9]=(d+c)*k;h[10]=(f+e)*g;h[11]=-1;h[12]=0;h[13]=0;h[14]=f*e*2*g;h[15]=0;return h};var z=
function(){};z.__name__=!0;z.i32ToFloat=function(a){var b=a>>>23&255,c=a&8388607;return 0==c&&0==b?0:(1-(a>>>31<<1))*(1+Math.pow(2,-23)*c)*Math.pow(2,b-127)};z.floatToI32=function(a){if(0==a)return 0;var b=0>a?-a:a,c=Math.floor(Math.log(b)/.6931471805599453);-127>c?c=-127:128<c&&(c=128);b=Math.round(8388608*(b/Math.pow(2,c)-1));8388608==b&&128>c&&(b=0,++c);return(0>a?-2147483648:0)|c+127<<23|b};var t={__ename__:!0,__constructs__:["NoIntersection","FoundIntersection","StillEvolving"],NoIntersection:["NoIntersection",
0]};t.NoIntersection.__enum__=t;t.FoundIntersection=["FoundIntersection",1];t.FoundIntersection.__enum__=t;t.StillEvolving=["StillEvolving",2];t.StillEvolving.__enum__=t;var F=function(a,b,c){this.distance=a;this.normal=b;this.index=c};F.__name__=!0;F.prototype={__class__:F};var D=function(){this.maxIterations=20};D.__name__=!0;D.prototype={calculateSupport:function(a){var b=new k(4);b[0]=0;b[1]=0;b[0]=-1*a[0];b[1]=-1*a[1];var c=this.shapeA.support(a);a=new k(4);a[0]=0;a[1]=0;a[0]=c[0];a[1]=c[1];
b=this.shapeB.support(b);a[0]-=b[0];a[1]-=b[1];return a},addSupport:function(a){var b=this.calculateSupport(a);this.vertices.push(b);return 0<=a[0]*b[0]+a[1]*b[1]},tripleProduct:function(a,b,c){var d=new k(4);d[0]=a[0];d[1]=a[1];d[2]=0;a=new k(4);a[0]=b[0];a[1]=b[1];a[2]=0;b=new k(4);b[0]=c[0];b[1]=c[1];b[2]=0;c=new k(4);c[0]=0;c[1]=0;c[2]=0;c=new k(4);c[0]=d[1]*a[2]-d[2]*a[1];c[1]=d[2]*a[0]-d[0]*a[2];c[2]=d[0]*a[1]-d[1]*a[0];d=c;a=new k(4);a[0]=0;a[1]=0;a[2]=0;a=new k(4);a[0]=d[1]*b[2]-d[2]*b[1];
a[1]=d[2]*b[0]-d[0]*b[2];a[2]=d[0]*b[1]-d[1]*b[0];b=a;d=new k(4);d[0]=b[0];d[1]=b[1];return d},evolveSimplex:function(){switch(this.vertices.length){case 0:var a=this.shapeB.get_centre(),b=this.shapeA.get_centre(),c=new k(4);c[0]=0;c[1]=0;c[0]=a[0]-b[0];c[1]=a[1]-b[1];this.direction=c;break;case 1:a=this.direction;b=new k(4);b[0]=0;b[1]=0;b[0]=-1*a[0];b[1]=-1*a[1];this.direction=b;break;case 2:b=this.vertices[1];c=this.vertices[0];a=new k(4);a[0]=0;a[1]=0;a[0]=b[0]-c[0];a[1]=b[1]-c[1];b=this.vertices[0];
c=new k(4);c[0]=0;c[1]=0;c[0]=-1*b[0];c[1]=-1*b[1];this.direction=this.tripleProduct(a,c,a);break;case 3:b=this.vertices[2];a=new k(4);a[0]=0;a[1]=0;a[0]=-1*b[0];a[1]=-1*b[1];var c=this.vertices[1],d=this.vertices[2],b=new k(4);b[0]=0;b[1]=0;b[0]=c[0]-d[0];b[1]=c[1]-d[1];var d=this.vertices[0],e=this.vertices[2],c=new k(4);c[0]=0;c[1]=0;c[0]=d[0]-e[0];c[1]=d[1]-e[1];d=this.tripleProduct(c,b,b);b=this.tripleProduct(b,c,c);if(0<d[0]*a[0]+d[1]*a[1])C.remove(this.vertices,this.vertices[0]),this.direction=
d;else if(0<b[0]*a[0]+b[1]*a[1])C.remove(this.vertices,this.vertices[1]),this.direction=b;else return t.FoundIntersection;break;default:throw new q("Can't have simplex with "+this.vertices.length+" verts!");}return this.addSupport(this.direction)?t.StillEvolving:t.NoIntersection},test:function(a,b){this.vertices=[];this.shapeA=a;this.shapeB=b;for(var c=t.StillEvolving,d=0;d<this.maxIterations&&c==t.StillEvolving;)c=this.evolveSimplex(),++d;return c==t.FoundIntersection},findClosestEdge:function(a){var b=
Infinity,c=new k(4);c[0]=0;var d=c[1]=0,e=new k(4);e[0]=0;for(var f=e[1]=0,h=this.vertices.length;f<h;){var g=f++,q=g+1;q>=this.vertices.length&&(q=0);var p=this.vertices[q];e[0]=p[0];e[1]=p[1];p=this.vertices[g];e[0]-=p[0];e[1]-=p[1];var l;switch(a[1]){case 0:l=new k(4);l[0]=e[1];l[1]=-e[0];break;case 1:l=new k(4),l[0]=-e[1],l[1]=e[0]}var p=Math.sqrt(l[0]*l[0]+l[1]*l[1]),m=0;p>=n.EPSILON&&(m=1/p);l[0]*=m;l[1]*=m;g=this.vertices[g];g=l[0]*g[0]+l[1]*g[1];g<b&&(b=g,c=l,d=q)}return new F(b,c,d)},intersect:function(a,
b){if(!this.test(a,b))return null;var c=0<=(this.vertices[1][0]-this.vertices[0][0])*(this.vertices[1][1]+this.vertices[0][1])+(this.vertices[2][0]-this.vertices[1][0])*(this.vertices[2][1]+this.vertices[1][1])+(this.vertices[0][0]-this.vertices[2][0])*(this.vertices[0][1]+this.vertices[2][1])?w.Clockwise:w.CounterClockwise,d=new k(4);d[0]=0;for(var e=d[1]=0;32>e;){e++;var f=this.findClosestEdge(c),h=this.calculateSupport(f.normal),g=f.normal,g=h[0]*g[0]+h[1]*g[1],n=f.normal;d[0]=n[0];d[1]=n[1];d[0]*=
g;d[1]*=g;if(1E-6>=Math.abs(g-f.distance))break;else this.vertices.splice(f.index,0,h)}return d},__class__:D};var w={__ename__:!0,__constructs__:["Clockwise","CounterClockwise"],Clockwise:["Clockwise",0]};w.Clockwise.__enum__=w;w.CounterClockwise=["CounterClockwise",1];w.CounterClockwise.__enum__=w;var A=function(){};A.__name__=!0;A.prototype={__class__:A};var x=function(a,b){this.set_centre(a);this.radius=b};x.__name__=!0;x.__interfaces__=[A];x.prototype={get_centre:function(){return this._centre},
set_centre:function(a){return this._centre=a},support:function(a){var b=this.get_centre(),c=new k(4);c[0]=0;c[1]=0;c[0]=b[0];c[1]=b[1];b=new k(4);b[0]=0;b[1]=0;var d=Math.sqrt(a[0]*a[0]+a[1]*a[1]),e=0;d>=n.EPSILON&&(e=1/d);b[0]=a[0]*e;b[1]=a[1]*e;a=this.radius;b[0]*=a;b[1]*=a;c[0]+=b[0];c[1]+=b[1];return c},__class__:x};var y=function(a){this.vertices=a};y.__name__=!0;y.__interfaces__=[A];y.prototype={get_centre:function(){var a=new k(4);a[0]=0;for(var b=a[1]=0,c=0,d=this.vertices;c<d.length;){var e=
d[c];++c;a[0]+=e[0];a[1]+=e[1];b+=1}b=1/b;a[0]*=b;a[1]*=b;return a},set_centre:function(a){var b=this.get_centre();b[0]=a[0]-b[0];b[1]=a[1]-b[1];for(var c=0,d=this.vertices;c<d.length;){var e=d[c];++c;e[0]+=b[0];e[1]+=b[1]}return a},support:function(a){for(var b=-Infinity,c=null,d=0,e=this.vertices;d<e.length;){var f=e[d];++d;var g=f[0]*a[0]+f[1]*a[1];g>b&&(b=g,c=f)}return c},__class__:y};var q=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,
q)};q.__name__=!0;q.wrap=function(a){return a instanceof Error?a:new q(a)};q.__super__=Error;q.prototype=function(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}(Error.prototype,{__class__:q});var g=function(){};g.__name__=!0;g.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=g.__nativeClassName(a);return null!=a?g.__resolveNativeClass(a):null};
g.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+g.__string_rec(a[f],b)):c+g.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+g.__string_rec(a[f],b);return d+
"]"}try{d=a.toString}catch(h){return"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+g.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};g.__interfLoop=function(a,b){if(null==
a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||g.__interfLoop(f,b))return!0}return g.__interfLoop(a.__super__,b)};g.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array?null==a.__enum__:!1;case K:return"boolean"==typeof a;case N:return!0;case L:return"number"==typeof a;case O:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(a instanceof
b||g.__interfLoop(g.getClass(a),b))return!0}else{if("object"==typeof b&&g.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==P&&null!=a.__name__||b==Q&&null!=a.__ename__?!0:a.__enum__==b}};g.__nativeClassName=function(a){a=g.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};g.__isNativeObj=function(a){return null!=g.__nativeClassName(a)};g.__resolveNativeClass=function(a){return B[a]};var r=function(a){if(a instanceof Array&&null==a.__enum__)this.a=
a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};r.__name__=!0;r.sliceImpl=function(a,b){var c=new M(this,a,null==b?null:b-a),d=new G(c.byteLength);(new M(d)).set(c);return d};r.prototype={slice:function(a,b){return new r(this.a.slice(a,b))},__class__:r};var u=function(){};u.__name__=!0;u._new=function(a,b,c){var d;if("number"==typeof a){d=[];for(b=0;b<a;){var e=b++;d[e]=0}d.byteLength=d.length<<2;d.byteOffset=0;a=[];b=0;for(e=d.length<<2;b<e;)b++,
a.push(0);d.buffer=new r(a)}else if(g.__instanceof(a,r)){null==b&&(b=0);null==c&&(c=a.byteLength-b>>2);d=[];for(e=0;e<c;){e++;var f=a.a[b++]|a.a[b++]<<8|a.a[b++]<<16|a.a[b++]<<24;d.push(z.i32ToFloat(f))}d.byteLength=d.length<<2;d.byteOffset=b;d.buffer=a}else if(a instanceof Array&&null==a.__enum__){d=a.slice();a=[];for(b=0;b<d.length;)e=d[b],++b,e=z.floatToI32(e),a.push(e&255),a.push(e>>8&255),a.push(e>>16&255),a.push(e>>>24);d.byteLength=d.length<<2;d.byteOffset=0;d.buffer=new r(a)}else throw new q("TODO "+
E.string(a));d.subarray=u._subarray;d.set=u._set;return d};u._set=function(a,b){if(g.__instanceof(a.buffer,r)){if(a.byteLength+b>this.byteLength)throw new q("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new q("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new q("TODO");};u._subarray=function(a,b){var c=u._new(this.slice(a,b));c.byteOffset=4*a;
return c};var v=function(){};v.__name__=!0;v._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new r(c)}else if(g.__instanceof(a,r))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new r(c);else throw new q("TODO "+E.string(a));c.subarray=v._subarray;c.set=
v._set;return c};v._set=function(a,b){if(g.__instanceof(a.buffer,r)){if(a.byteLength+b>this.byteLength)throw new q("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new q("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new q("TODO");};v._subarray=function(a,b){var c=v._new(this.slice(a,b));c.byteOffset=a;return c};String.prototype.__class__=String;
String.__name__=!0;Array.__name__=!0;var O={__name__:["Int"]},N={__name__:["Dynamic"]},L=Number;L.__name__=["Float"];var K=Boolean;K.__ename__=["Bool"];var P={__name__:["Class"]},Q={},G=B.ArrayBuffer||r;null==G.prototype.slice&&(G.prototype.slice=r.sliceImpl);var k=B.Float32Array||u._new,M=B.Uint8Array||v._new;f.lastTime=0;n.EPSILON=1E-7;g.__toStr={}.toString;u.BYTES_PER_ELEMENT=4;v.BYTES_PER_ELEMENT=1;f.main()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?
self:this);
